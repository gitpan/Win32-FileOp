<!-- $Id$ -->
<HTML><HEAD>
<CENTER><TITLE>FileOp.pm</TITLE>
</HEAD>
<BODY></CENTER><p><hr>

<H1> 
<A NAME="FileOp.pm_win_fileop_0">
Win32::FileOp</A>
</H1>
Module for file operations with fancy dialog boxes, for moving files
to recycle bin, reading and updating INI files and file operations in general.
<p>Unless mentioned otherwise all functions work both under WinNT and Win95.
<p>Version 0.10.1
<p>
<H2> 
<A NAME="FileOp.pm_functions_0">
Functions</A>
</H2>

<A HREF="FileOp.pm.html#FileOp.pm_getdesktophandle_0"><EM>GetDesktopHandle </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_getwindowhandle_0"><EM>GetWindowHandle </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_copy_0"><EM>Copy </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_copyconfirm_0"><EM>CopyConfirm </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_copyconfirmeach_0"><EM>CopyConfirmEach </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_copyex_0"><EM>CopyEx </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_move_0"><EM>Move </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_moveconfirm_0"><EM>MoveConfirm </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_moveconfirmeach_0"><EM>MoveConfirmEach </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_moveex_0"><EM>MoveEx </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_movefile_0"><EM>MoveFile </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_movefileex_0"><EM>MoveFileEx </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_copyfile_0"><EM>CopyFile </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_moveatreboot_0"><EM>MoveAtReboot </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_recycle_0"><EM>Recycle </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_recycleconfirm_0"><EM>RecycleConfirm </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_recycleconfirmeach_0"><EM>RecycleConfirmEach </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_recycleex_0"><EM>RecycleEx </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_delete_0"><EM>Delete </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_deleteconfirm_0"><EM>DeleteConfirm </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_deleteconfirmeach_0"><EM>DeleteConfirmEach </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_deleteex_0"><EM>DeleteEx </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_deleteatreboot_0"><EM>DeleteAtReboot </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_updatedir_0"><EM>UpdateDir </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_fillindir_0"><EM>FillInDir </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_compress_0"><EM>Compress </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_uncompress_0"><EM>Uncompress </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_compressed_0"><EM>Compressed </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_setcompression_0"><EM>SetCompression </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_getcompression_0"><EM>GetCompression </EM> </A>


<A HREF="FileOp.pm.html#FileOp.pm_compressdir_0"><EM>CompressDir </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_uncompressdir_0"><EM>UncompressDir </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_addtorecentdocs_0"><EM>AddToRecentDocs </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_emptyrecentdocs_0"><EM>EmptyRecentDocs </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_writetoini_0"><EM>WriteToINI </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_writetowinini_0"><EM>WriteToWININI </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_readini_0"><EM>ReadINI </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_readwinini_0"><EM>ReadWININI </EM> </A>
 
<p>
<A HREF="FileOp.pm.html#FileOp.pm_deletefromini_0"><EM>DeleteFromINI </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_deletefromwinini_0"><EM>DeleteFromWININI </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_opendialog_0"><EM>OpenDialog </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_saveasdialog_0"><EM>SaveAsDialog </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_browseforfolder_0"><EM>BrowseForFolder </EM> </A>

<p>
<A HREF="FileOp.pm.html#FileOp.pm_map_0"><EM>Map </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_unmap_0"><EM>Unmap </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_disconnect_0"><EM>Disconnect </EM> </A>
 
<A HREF="FileOp.pm.html#FileOp.pm_mapped_0"><EM>Mapped </EM> </A>

<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="FileOp.pm_getdesktophandle_0">
GetDesktopHandle</A>

</STRONG>
<DD>

<XMP>
 use Win32::FileOp
 $handle = GetDesktopHandle()

</XMP>
<p>Same as: <STRONG>$handle</STRONG> = <STRONG>$Win32::FileOp::DesktopHandle</STRONG>
<p>Used to get desktop window handle when confirmation is used.
The value of the handle can be gotten from <STRONG>$Win32::FileOp::DesktopHandle</STRONG>.
<p>Returns the Desktop Window handle.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_getwindowhandle_0">
GetWindowHandle</A>

</STRONG>
<DD>

<XMP>
 use Win32::FileOp
 $handle = GetWindowHandle()

</XMP>
<p>Same as: <STRONG>$handle</STRONG> = <STRONG>$Win32::FileOp::WindowHandle</STRONG>
<p>Used to get the console window handle when confirmation is used.
The value of the handle can be gotten from <STRONG>$Win32::FileOp::WindowHandle</STRONG>.
<p>Returns the Console Window handle.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_copy_0">
Copy</A>

</STRONG>
<DD>

<XMP>
 Copy ($FileName => $FileOrDirectoryName [, ...])
 Copy (\@FileNames => $DirectoryName [, ...] )
 Copy (\@FileNames => \@FileOrDirectoryNames [, ...])

</XMP>
<p>Copies the specified files. Doesn't show any confirmation nor progress dialogs.
<p>It may show an error message dialog, because I had to omit FOF_NOERRORUI
from its call to allow for autocreating directories.
<p>You should end the directory names by backslash so that they are
not mistaken for filenames. It is not necessary if
the directory already exists or if you use Copy \<STRONG>@filenames</STRONG> =&gt; <STRONG>$dirname</STRONG>.
<p>Returns true if successful.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_copyconfirm_0">
CopyConfirm</A>

</STRONG>
<DD>

<XMP>
 CopyConfirm ($FileName => $FileOrDirectoryName [, ...])
 CopyConfirm (\@FileNames => $DirectoryName [, ...] )
 CopyConfirm (\@FileNames => \@FileOrDirectoryNames [, ...])

</XMP>
<p>Copies the specified files. In case of a collision, shows a confirmation dialog.
Shows progress dialogs.
<p>Returns true if successful.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_copyconfirmeach_0">
CopyConfirmEach</A>

</STRONG>
<DD>
The same as CopyConfirm.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_copyex_0">
CopyEx</A>

</STRONG>
<DD>

<XMP>
 CopyEx ($FileName => $FileOrDirectoryName, [...], $options)
 CopyEx (\@FileNames => $DirectoryName, [...], $options)
 CopyEx (\@FileNames => \@FileOrDirectoryNames, [...], $options)

</XMP>
<p>Copies the specified files. See below for the available options (
<A HREF="FileOp.pm.html#FileOp.pm_fof_0"><EM>FOF_ </EM> </A>
 constants).
<p>Returns true if successful.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_move_0">
Move</A>

</STRONG>
<DD>
Moves the specified files. Parameters as 
<A HREF="FileOp.pm.html#FileOp.pm_copy_0"><EM>Copy </EM> </A>

<p>It may show an error message dialog, because I had to omit FOF_NOERRORUI
from its call to allow for autocreating directories.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_moveconfirm_0">
MoveConfirm</A>

</STRONG>
<DD>
Moves the specified files. Parameters as 
<A HREF="FileOp.pm.html#FileOp.pm_copyconfirm_0"><EM>CopyConfirm </EM> </A>

<p>
<DT><STRONG>

<A NAME="FileOp.pm_moveconfirmeach_0">
MoveConfirmEach</A>

</STRONG>
<DD>
The same as MoveConfirm
<p>
<DT><STRONG>

<A NAME="FileOp.pm_moveex_0">
MoveEx</A>

</STRONG>
<DD>
Moves the specified files. Parameters as 
<A HREF="FileOp.pm.html#FileOp.pm_copyex_0"><EM>CopyEx </EM> </A>

<p>
<DT><STRONG>

<A NAME="FileOp.pm_moveatreboot_0">
MoveAtReboot</A>

</STRONG>
<DD>

<XMP>
 MoveAtReboot ($FileName => $DestFileName, [...])

</XMP>
<p>This function moves the file during the next start of the system.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_movefile_0">
MoveFile</A>

</STRONG>
<DD>

<XMP>
 MoveFile ($FileName => $DestFileName [, ...])

</XMP>
<p>Move files. This function uses API function MoveFileEx as well
as MoveAtReboot. It may be a little quicker than 
<A HREF="FileOp.pm.html#FileOp.pm_move_0"><EM>Move </EM> </A>
, but
it doesn't understand wildcards and the <STRONG>$DestFileName</STRONG> may not be a directory.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_movefileex_0">
MoveFileEx</A>

</STRONG>
<DD>

<XMP>
 MoveFileEx ($FileName => $DestFileName [, ...], $options)

</XMP>
<p>This is a simple wrapper around the API function MoveFileEx, it calls the function
for every pair of files with the <STRONG>$options</STRONG> you specify.
See below for the available options (
<A HREF="FileOp.pm.html#FileOp.pm_fof_0"><EM>FOF_ </EM> </A>
... constants).
<p>
<DT><STRONG>

<A NAME="FileOp.pm_copyfile_0">
CopyFile</A>

</STRONG>
<DD>

<XMP>
 CopyFile ($FileName => $DestFileName [, $FileName2 => $DestFileName2 [, ...]])

</XMP>
<p>Copy a file somewhere. This function is not able to copy directories!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_recycle_0">
Recycle</A>

</STRONG>
<DD>

<XMP>
 Recycle @filenames

</XMP>
<p>Send the files into the recycle bin. You will not get any confirmation dialogs.
<p>Returns true if successful.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_recycleconfirm_0">
RecycleConfirm</A>

</STRONG>
<DD>

<XMP>
 RecycleConfirm @filenames

</XMP>
<p>Send the files into the recycle bin. You will get a confirmation dialog if you
have ``Display delete confirmation dialog'' turned on in your recycle bin. You
will confirm the deletion of all the files at once.
<p>Returns true if successful. Please remember that this function is successful
even if the user chose [No] on the confirmation dialog!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_recycleconfirmeach_0">
RecycleConfirmEach</A>

</STRONG>
<DD>

<XMP>
 RecycleConfirmEach @filenames

</XMP>
<p>Send the files into the recycle bin. You will get a separate confirmation
dialog for each file if you have ``Display delete confirmation dialog'' turned
on in your recycle bin. You will confirm the deletion of all the files at once.
<p>Returns the number of files that were successfully deleted.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_recycleex_0">
RecycleEx</A>

</STRONG>
<DD>

<XMP>
 RecycleEx @filenames, $options

</XMP>
<p>Send the files into the recycle bin. You may specify the options for deleting,
see below.  You may get a confirmation dialog if you have "Display delete
confirmation dialog" turned on in your recycle bin, if so, you will confirm the
deletion of all the files at once.
<p>Returns true if successful. Please remember that this function is successful
even if the user chose [No] on the confirmation dialog!
<p>The <STRONG>$options</STRONG> may be constructed from 
<A HREF="FileOp.pm.html#FileOp.pm_fof_0"><EM>FOF_ </EM> </A>
... constants.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_delete_0">
Delete</A>

</STRONG>
<DD>

<XMP>
 Delete @filenames

</XMP>
<p>Deletes the files. You will not get any confirmation dialogs.
<p>Returns true if successful.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_deleteconfirm_0">
DeleteConfirm</A>

</STRONG>
<DD>

<XMP>
 DeleteConfirm @filenames

</XMP>
<p>Deletes the the files. You will get a confirmation dialog to confirm
the deletion of all the files at once.
<p>Returns true if successful. Please remember that this function is successful
even if the user selected [No] on the confirmation dialog!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_deleteconfirmeach_0">
DeleteConfirmEach</A>

</STRONG>
<DD>

<XMP>
 DeleteConfirmEach @filenames

</XMP>
<p>Deletes the files. You will get a separate confirmation dialog for each file.
<p>Returns the number of files that were successfully deleted.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_deleteex_0">
DeleteEx</A>

</STRONG>
<DD>

<XMP>
 DeleteEx @filenames, $options

</XMP>
<p>Deletes the files. You may specify the options for deleting,
see below.  You may get a confirmation dialog if you have "Display delete
confirmation dialog" turned on in your recycle bin.
<p>Returns true if successful. Please remember that this function is successful
even if the user selected [No] on the confirmation dialog!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_deleteatreboot_0">
DeleteAtReboot</A>

</STRONG>
<DD>

<XMP>
 DeleteAtReboot @files

</XMP>
<p>This function moves the file during the next start of the system.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_updatedir_0">
UpdateDir</A>

</STRONG>
<DD>

<XMP>
 UpdateDir $SourceDirectory, $DestDirectory [, \&callback]

</XMP>
<p>Copy the newer or updated files from <STRONG>$SourceDir</STRONG> to <STRONG>$DestDir</STRONG>. Processes subdirectories!
The &amp;callback function is called for each file to be copied.
The parameters it gets are exactly the same as the callback function
in File::Find. That is <STRONG>$_</STRONG>, <STRONG>$File::Find::dir</STRONG> and <STRONG>$File::Find::name</STRONG>.
<p>If this function returns a false value, the file is skipped.
<p>
<XMP>
 Ex.
  UpdateDir 'c:\dir' => 'e:\dir', sub {print '.'};
  UpdateDir 'c:\dir' => 'e:\dir', sub {if (/^s/i) {print '.'}};

</XMP>
<p>
<DT><STRONG>

<A NAME="FileOp.pm_fillindir_0">
FillInDir</A>

</STRONG>
<DD>

<XMP>
 FillInDir $SourceDirectory, $DestDirectory [, \&callback]

</XMP>
<p>Copy the files from <STRONG>$SourceDir</STRONG> not present in <STRONG>$DestDir</STRONG>. Processes subdirectories!
The &amp;callback works the same as in UpdateDir.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_compress_0">
Compress</A>

</STRONG>
<DD>

<XMP>
 Compress $filename [, ...]

</XMP>
<p>Compresses the file(s) or directories using the transparent WinNT compression
(The same as checking the ``Compressed'' checkbox in Explorer properties
fo the file).
<p>It doesn't compress all files and subdirectories in a directory you
specify. Use ComressDir for that. Compress(<STRONG>$directory</STRONG>) only sets the compression flag for
the directory so that the new files are compressed by default. 
<p>WinNT only!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_uncompress_0">
Uncompress</A>

</STRONG>
<DD>

<XMP>
 Uncompress $filename [, ...]

</XMP>
<p>Uncompresses the file(s) using the transparent WinNT compression
(The same as unchecking the ``Compressed'' checkbox in Explorer properties
fo the file).
<p>WinNT only!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_compressed_0">
Compressed</A>

</STRONG>
<DD>

<XMP>
 Compressed $filename

</XMP>
<p>Checks the compression status for a file.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_setcompression_0">
SetCompression</A>

</STRONG>
<DD>

<XMP>
 SetCompression $filename [, $filename], $value

</XMP>
<p>Sets the compression status for file(s). The <STRONG>$value</STRONG> should be
either 1 or 0.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_getcompression_0">
GetCompression</A>

</STRONG>
<DD>

<XMP>
 GetCompression $filename

</XMP>
<p>Checks the compression status for a file.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_compressdir_0">
CompressDir</A>

</STRONG>
<DD>

<XMP>
 CompressDir $directory, ... [, \&callback]

</XMP>
<p>Recursively descends the directory(ies) specified and compresses all files
and directories within. If you specify the \&amp;callback, the specified function
gets executed for each of the files and directories. If the callback returns false,
no compression is done on the file/directory.
<p>The parameters the callback gets are exactly the same as the callback function
in File::Find. That is <STRONG>$_</STRONG>, <STRONG>$File::Find::dir</STRONG> and <STRONG>$File::Find::name</STRONG>.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_uncompressdir_0">
UncompressDir</A>

</STRONG>
<DD>

<XMP>
 UncompressDir $directory, ... [, \&callback]

</XMP>
<p>The counterpart of CompressDir. 
<p>
<DT><STRONG>

<A NAME="FileOp.pm_addtorecentdocs_0">
AddToRecentDocs</A>

</STRONG>
<DD>

<XMP>
 AddToRecentDocs $filename [, ...]

</XMP>
<p>Add a shortcut(s) to the file(s) into the Recent Documents folder.
The shortcuts will appear in the Documents submenu of Start Menu.
<p>The paths may be relative.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_emptyrecentdocs_0">
EmptyRecentDocs</A>

</STRONG>
<DD>

<XMP>
 EmptyRecentDocs;

</XMP>
<p>Deletes all shortcuts from the Recent Documents folder.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_writetoini_0">
WriteToINI</A>

</STRONG>
<DD>

<XMP>
 WriteToINI $INIfile, $section, $name1 => $value [, $name2 => $value2 [, ...]]

</XMP>
<p>Copies a string into the specified section of the specified initialization file.
You may pass several name/value pairs at once.
<p>Returns 1 if successful, undef otherwise. See Win32::GetLastError &amp;
Win32::FormatMessage(Win32::GetLastError) if failed for the error code and message.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_writetowinini_0">
WriteToWININI</A>

</STRONG>
<DD>

<XMP>
 WriteToWININI $section, $name1 => $value1 [, $name2 => $value2 [, ...]]

</XMP>
<p>Copies a string into the specified section of WIN.INI.
You may pass several name/value pairs at once.
<p>Please note that some values or sections of WIN.INI and some other INI
files are mapped to registry so they do not show up
in the INI file even if they were successfully written!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_readini_0">
ReadINI</A>

</STRONG>
<DD>

<XMP>
    $value = ReadINI $INIfile, $section, $name [, $defaultvalue]

</XMP>
<p>Reads a value from an INI file. If you do not specify the default
and the value is not found you'll get undef.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_readwinini_0">
ReadWININI</A>

</STRONG>
<DD>

<XMP>
    $value = ReadWININI $section, $name [, $defaultvalue]

</XMP>
<p>Reads a value from WIN.INI file. If you do not specify the default
and the value is not found you'll get undef.
<p>Please note that some values or sections of WIN.INI and some other INI
files are mapped to registry so even that they do not show up
in the INI file this function will find and read them!
<p>
<DT><STRONG>

<A NAME="FileOp.pm_deletefromini_0">
DeleteFromINI</A>

</STRONG>
<DD>

<XMP>
 DeleteFromINI $INIfile, $section, @names_to_delete

</XMP>
<p>Delete a value from an INI file.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_deletefromwinini_0">
DeleteFromWININI</A>

</STRONG>
<DD>

<XMP>
 DeleteFromWININI $section, @names_to_delete

</XMP>
<p>Delete a value from WIN.INI.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_readinisections_0">
ReadINISections</A>

</STRONG>
<DD>

<XMP>
 @sections = ReadINISections($inifile);
 \@sections = ReadINISections($inifile);
 ReadINISections($inifile,\@sections);

</XMP>
<p>Enumerate the sections in a INI file. If you do not specify the INI file,
it enumerates the contents of win.ini.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_readinisectionkeys_0">
ReadINISectionKeys</A>

</STRONG>
<DD>

<XMP>
 @sections = ReadINISectionKeys($inifile, $section);
 \@sections = ReadINISectionKeys($inifile, $section);
 ReadINISectionKeys($inifile, $section, \@sections);

</XMP>
<p>Enumerate the keys in a section of a INI file. If you do not specify the
INI file, it enumerates the contents of win.ini.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_opendialog_0">
OpenDialog</A>

</STRONG>
<DD>

<XMP>
 $filename = OpenDialog \%parameters [, $defaultfilename]
 @filenames = OpenDialog \%parameters [, $defaultfilename]
 $filename = OpenDialog %parameters [, $defaultfilename]
 @filenames = OpenDialog %parameters [, $defaultfilename]

</XMP>
<p>Creates the standard Open dialog allowing you to select some files.
<p>Returns a list of selected files or undef if the user pressed [Escape].
It also sets two global variables :
<p>
<XMP>
 $Win32::FileOp::ReadOnly = the user requested a readonly access.
 $Win32::FileOp::SelectedFilter = the id of filter selected in the dialogbox
 %parameters
  title => the title for the dialog, default is 'Open'
        'Open file'
  filters => definition of file filters
        { 'Filter 1' => '*.txt;*.doc', 'Filter 2' => '*.pl;*.pm'}
        [ 'Filter 1' => '*.txt;*.doc', 'Filter 2' => '*.pl;*.pm']
        [ 'Filter 1' => '*.txt;*.doc', 'Filter 2' => '*.pl;*.pm' , $default]
        "Filter 1\0*.txt;*.doc\0Filter 2\0*.pl;*.pm"
  defaultfilter => the number of the default filter counting from 1.
                   Please keep in mind that hashes do not preserve
                   ordering!
  dir => the initial directory for the dialog, default is the current directory
  filename => the default filename to be showed in the dialog
  extension => the default extension, this function appends this extension to
               the filename if the user fails to type an extension. This
               string can be any length, but only the first three characters
               are appended. The string should not contain a period (.).
  handle => the handle to the window which will own this dialog
            Default is the console of the perl script.
            If you do not want to tie the dialog to any window use
            handle => 0
  options => options for the dialog, see bellow OFN_... constants

</XMP>
<p>
<DT><STRONG>

<A NAME="FileOp.pm_saveasdialog_0">
SaveAsDialog</A>

</STRONG>
<DD>
Creates the Save As dialog box, parameters are the same as for OpenDialog.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_browseforfolder_0">
BrowseForFolder</A>

</STRONG>
<DD>

<XMP>
 BrowseForFolder [$title [, $rootFolder [, $options]]]

</XMP>
<p>Creates the standard ``Browse For Folder'' dialog.
The <STRONG>$title</STRONG> specifies the text to be displayed below the title of the dialog.
The <STRONG>$rootFolder</STRONG> may be one of the 
<A HREF="FileOp.pm.html#FileOp.pm_csidl_0"><EM>CSIDL_ </EM> </A>
... constants.
For <STRONG>$options</STRONG> you should use the 
<A HREF="FileOp.pm.html#FileOp.pm_bif_0"><EM>BIF_ </EM> </A>
... constants. Description
of the constants is bellow.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_map_0">
Map</A>

</STRONG>
<DD>

<XMP>
 Map $drive => $share;
 $drive = Map $share;
 Map $drive => $share, \%options;
 $drive = Map $share, \%options;

</XMP>
<p>Map a drive letter or LTPx to a network resource. If successfull returns the drive letter/LPTx.
<p>If you do not specify the drive letter, the function uses the last free
letter. Since the function doesn't require the ':' in the drive name you
may use the function like this:
<p>
<XMP>
 Map H => '\\\\server\share';
 as well as
 Map 'H:' => '\\\\server\share';
 Options:
  persistent = 0/1, should the connection be restored on next logon?
  user       = username to be used to connect the device
  passwd     = password to be used to connect the device
  overwrite  = 0/1, should the drive be remapped if it was already connected?
 Example:
  Map I => '\\\\servername\share', {persistent=>1,overwrite=>1};

</XMP>
<p>
<DT><STRONG>

<A NAME="FileOp.pm_disconnect_0">
Disconnect</A>

</STRONG>
<DD>

<XMP>
 Disconnect $drive_or_share;
 Disconnect $drive_or_share, \%options;

</XMP>
<p>Breaks an existing network connection. It can also be used to remove
remembered network connections that are not currently connected.
<p><STRONG>$drive_or_share</STRONG> specifies the name of either the redirected local device
or the remote network resource to disconnect from. If this parameter
specifies a redirected local resource, only the specified redirection is
broken; otherwise, all connections to the remote network resource are
broken. 
<p>
<XMP>
 Options:
  persistent = 0/1, if you do not use persistent=>1, the connection will be closed, but
               the drive letter will still be mapped to the device
  force      = 0/1, disconnect even if there are some open files
 See also: Unmap

</XMP>
<p>
<DT><STRONG>

<A NAME="FileOp.pm_unmap_0">
Unmap</A>

</STRONG>
<DD>

<XMP>
 Unmap $drive_or_share;
 Unmap $drive_or_share, \%options;

</XMP>
<p>The only difference from Disconnect is that persistent=&gt;1 is the default.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_mapped_0">
Mapped</A>

</STRONG>
<DD>

<XMP>
 %drives = Mapped;
 $share = Mapped $drive;
 $drive = Mapped $share; # currently not implemented !!!

</XMP>
<p>This function retrieves the name of the network resource associated with a local device.
Or vice versa.
<p>If you do not specify any parameter, you get a hash of drives and shares.
<p>To get the error message from most of these functions, you should not use $!, but
Win32::FormatMessage(Win32::<EM>GetLastError()</EM>)!
<p>
</DL>
.
<p>
<H2> 
<A NAME="FileOp.pm_options_0">
Options</A>
</H2>
<p>
<DL COMPACT>
<DT><STRONG>

<A NAME="FileOp.pm_fof_0">
FOF_</A>

</STRONG>
<DD>

<XMP>
 FOF_SILENT = do not show the progress dialog
 FOF_RENAMEONCOLLISION = rename the file in case of collision
            ('file.txt' -> 'Copy of file.txt')
 FOF_NOCONFIRMATION = do not show the confirmation dialog
 FOF_ALLOWUNDO = send file(s) to RecycleBin instead of deleting
 FOF_FILESONLY = skip directories
 FOF_SIMPLEPROGRESS = do not show the filenames in the process dialog
 FOF_NOCONFIRMMKDIR = do not confirm creating directories
 FOF_NOERRORUI = do not report errors
 FOF_NOCOPYSECURITYATTRIBS = do not copy security attributes

</XMP>
<p>
<DT><STRONG>

<A NAME="FileOp.pm_ofn_0">
OFN_</A>

</STRONG>
<DD>

<XMP>
 OFN_ALLOWMULTISELECT    

</XMP>
<p>Specifies that the File Name list box allows multiple selections. If you
also set the OFN_EXPLORER flag, the dialog box uses the Explorer-style
user interface; otherwise, it uses the old-style user interface.
<p>
<XMP>
 OFN_CREATEPROMPT

</XMP>
<p>If the user specifies a file that does not exist, this flag causes the
dialog box to prompt the user for permission to create the file. If the
user chooses to create the file, the dialog box closes and the function
returns the specified name; otherwise, the dialog box remains open.
<p>
<XMP>
 OFN_EXPLORER

</XMP>
<p>Since I cannot implement hook procedures through Win32::API (AFAIK),
this option in not necessary.
<p>
<XMP>
 OFN_FILEMUSTEXIST

</XMP>
<p>Specifies that the user can type only names of existing files in the
File Name entry field. If this flag is specified and the user enters an
invalid name, the dialog box procedure displays a warning in a message
box. If this flag is specified, the OFN_PATHMUSTEXIST flag is also used.
<p>
<XMP>
 OFN_HIDEREADONLY

</XMP>
<p>Hides the Read Only check box.
<p>
<XMP>
 OFN_LONGNAMES    

</XMP>
<p>For old-style dialog boxes, this flag causes the dialog box to use long
filenames. If this flag is not specified, or if the OFN_ALLOWMULTISELECT
flag is also set, old-style dialog boxes use short filenames (8.3
format) for filenames with spaces. Explorer-style dialog boxes ignore
this flag and always display long filenames.
<p>
<XMP>
 OFN_NOCHANGEDIR    

</XMP>
<p>Restores the current directory to its original value if the user changed
the directory while searching for files.
<p>
<XMP>
 OFN_NODEREFERENCELINKS

</XMP>
<p>Directs the dialog box to return the path and filename of the selected
shortcut (.LNK) file. If this value is not given, the dialog box returns
the path and filename of the file referenced by the shortcut
<p>
<XMP>
 OFN_NOLONGNAMES    

</XMP>
<p>For old-style dialog boxes, this flag causes the dialog box to use short
filenames (8.3 format). Explorer-style dialog boxes ignore this flag and
always display long filenames.
<p>
<XMP>
 OFN_NONETWORKBUTTON

</XMP>
<p>Hides and disables the Network button.
<p>
<XMP>
 OFN_NOREADONLYRETURN

</XMP>
<p>Specifies that the returned file does not have the Read Only check box
checked and is not in a write-protected directory.
<p>
<XMP>
 OFN_NOTESTFILECREATE    

</XMP>
<p>Specifies that the file is not created before the dialog box is closed.
This flag should be specified if the application saves the file on a
create-nonmodify network sharepoint. When an application specifies this
flag, the library does not check for write protection, a full disk, an
open drive door, or network protection. Applications using this flag
must perform file operations carefully, because a file cannot be
reopened once it is closed.
<p>
<XMP>
 OFN_NOVALIDATE    

</XMP>
<p>Specifies that the dialog boxes allow invalid characters in the returned
filename. 
<p>
<XMP>
 OFN_OVERWRITEPROMPT    

</XMP>
<p>Causes the Save As dialog box to generate a message box if the selected
file already exists. The user must confirm whether to overwrite the
file.
<p>
<XMP>
 OFN_PATHMUSTEXIST    

</XMP>
<p>Specifies that the user can type only valid paths and filenames. If this
flag is used and the user types an invalid path and filename in the File
Name entry field, the dialog box function displays a warning in a
message box.
<p>
<XMP>
 OFN_READONLY    

</XMP>
<p>Causes the Read Only check box to be checked initially when the dialog
box is created. If the check box is checked when the dialog box is closed
<STRONG>$Win32::FileOp::ReadOnly</STRONG> is set to true.
<p>
<XMP>
 OFN_SHAREAWARE    

</XMP>
<p>Specifies that if a call to the OpenFile function fails because of a
network sharing violation, the error is ignored and the dialog box
returns the selected filename. 
<p>
<XMP>
 OFN_SHOWHELP

</XMP>
<p>Causes the dialog box to display the Help button. The hwndOwner member
must specify the window to receive the HELPMSGSTRING registered messages
that the dialog box sends when the user clicks the Help button.
<p>
<DT><STRONG>

<A NAME="FileOp.pm_bif_0">
BIF_</A>

</STRONG>
<DD>

<XMP>
 BIF_DONTGOBELOWDOMAIN

</XMP>
<p>Does not include network folders below the domain level in the tree view
control.
<p>
<XMP>
 BIF_RETURNONLYFSDIRS

</XMP>
<p>Only returns file system directories. If the user selects folders that
are not part of the file system, the OK button is grayed.
<p>
<XMP>
 BIF_RETURNFSANCESTORS

</XMP>
<p>Only returns file system ancestors. If the user selects anything other
than a file system ancestor, the OK button is grayed.
<p>This option is strange, cause it seems to allow you to select only computers.
I don't know the definition of a filesystem ancestor, but I didn't think
it would be a computer. ?-|
<p>
<XMP>
 BIF_BROWSEFORCOMPUTER

</XMP>
<p>Only returns computers. If the user selects anything other than a
computer, the OK button is grayed.
<p>
<XMP>
 BIF_BROWSEFORPRINTER

</XMP>
<p>Only returns printers. If the user selects anything other than a
printer, the OK button is grayed.
<p>
<XMP>
 BIF_STATUSTEXT

</XMP>
<p>Since it is currently impossible to define callbacks, this options is
useless. 
<p>
<DT><STRONG>

<A NAME="FileOp.pm_csidl_0">
CSIDL_</A>

</STRONG>
<DD>
CSIDL_BITBUCKET
<p>Recycle bin --- file system directory containing file objects in the
user's recycle bin. The location of this directory is not in the
registry; it is marked with the hidden and system attributes to prevent
the user from moving or deleting it.
<p>CSIDL_CONTROLS
<p>Control Panel --- virtual folder containing icons for the control panel
applications.
<p>CSIDL_DESKTOP
<p>Windows desktop --- virtual folder at the root of the name space.
<p>CSIDL_DESKTOPDIRECTORY
<p>File system directory used to physically store file objects on the
desktop (not to be confused with the desktop folder itself).
<p>CSIDL_DRIVES
<p>My Computer --- virtual folder containing everything on the local
computer: storage devices, printers, and Control Panel. The folder may
also contain mapped network drives.
<p>CSIDL_FONTS
<p>Virtual folder containing fonts.
<p>CSIDL_NETHOOD
<p>File system directory containing objects that appear in the network
neighborhood.
<p>CSIDL_NETWORK
<p>Network Neighborhood --- virtual folder representing the top level of the
network hierarchy.
<p>CSIDL_PERSONAL
<p>File system directory that serves as a common repository for documents.
<p>CSIDL_PRINTERS
<p>Printers folder --- virtual folder containing installed printers.
<p>CSIDL_PROGRAMS
<p>File system directory that contains the user's program groups (which are
also file system directories).
<p>CSIDL_RECENT
<p>File system directory that contains the user's most recently used
documents.
<p>CSIDL_SENDTO
<p>File system directory that contains Send To menu items.
<p>CSIDL_STARTMENU
<p>File system directory containing Start menu items.
<p>CSIDL_STARTUP
<p>File system directory that corresponds to the user's Startup program
group.
<p>CSIDL_TEMPLATES
<p>File system directory that serves as a common repository for document
templates.
<p>Not all options make sense in all functions!
<p>
<H2> 
<A NAME="FileOp.pm_variables_0">
Variables</A>
</H2>

<XMP>
 $Win32::FileOp::ProgressTitle

</XMP>
<p>This variable (if defined) contains the text to be displayed on
the progress dialog if using FOF_SIMPLEPROGRESS. This allows you
to present the user with your own message about what is happening
to his computer.
<p>If the options for the call do not contain FOF_SIMPLEPROGRESS, this
variable is ignored.
<p>
<H2> 
<A NAME="FileOp.pm_examples_0">
Examples</A>
</H2>

<XMP>
    use Win32::FileOp;
    CopyConfirm ('c:\temp\kinter.pl' => 'c:\temp\copy\\',
                 ['\temp\kinter1.pl', 'temp\kinter2.pl']
                 => ['c:\temp\copy1.pl', 'c:\temp\copy2.pl']);
    $Win32::FileOp::ProgressTitle = "Moving the temporary files ...";
    MoveEx 'c:\temp\file.txt' => 'd:\temp\\',
           ['c:\temp\file1.txt','c:\temp\file2.txt'] => 'd:\temp',
           FOF_RENAMEONCOLLISION | FOF_SIMPLEPROGRESS;
    undef $Win32::FileOp::ProgressTitle;
    Recycle 'c:\temp\kinter.pl';

</XMP>
<p>
<H2> 
<A NAME="FileOp.pm_handles_0">
Handles</A>
</H2>
All the functions keep Win32::API handles between calls. If you want to free the handles
you may undefine them, but NEVER EVER set them to anything else than undef !!!
Even  ``<STRONG>$handlename</STRONG> = <STRONG>$handlename</STRONG>;'' would destroy the handle without repair!
See docs for Lazy.pm for explanation.
<p>List of handles and functions that use them:
<p>
<XMP>
 $Win32::FileOp::fileop : Copy, CopyEx, CopyConfirm, Move, MoveEx, MoveConfirm
  Delete, DeleteEx, DeleteConfirm, Recycle, RecycleEx, RecycleConfirm
 $Win32::FileOp::movefileex : MoveFileEx MoveFile MoveAtReboot
 $Win32::FileOp::movefileexDel : DeleteAtReboot
 $Win32::FileOp::copyfile : CopyFile
 $Win32::FileOp::writeINI : WriteToINI MoveAtReboot DeleteAtReboot
 $Win32::FileOp::writeWININI : WriteToWININI
 $Win32::FileOp::deleteINI : DeleteFromINI
 $Win32::FileOp::deleteWININI : DeleteFromWININI
 $Win32::FileOp::readINI : ReadINI
 $Win32::FileOp::readWININI : ReadWININI
 $Win32::FileOp::GetOpenFileName : OpenDialog
 $Win32::FileOp::GetSaveFileName : SaveAsDialog
 $Win32::FileOp::SHAddToRecentDocs : AddToRecentDocs EmptyRecentDocs
 $Win32::FileOp::DesktopHandle
 $Win32::FileOp::WindowHandle : OpenDialog SaveDialog
 $Win32::FileOp::WNetAddConnection3 : Map
 $Win32::FileOp::WNetGetConnection : Mapped
 $Win32::FileOp::WNetCancelConnection2 : Unmap Disconnect Map
 $Win32::FileOp::GetLogicalDrives : FreeDriveLetters Map

</XMP>
<p>
<H2> 
<A NAME="FileOp.pm_notes_0">
Notes</A>
</H2>
By default all functions are exported! If you do not want to polute your
namespace too much import only the functions you need.
You may import either single functions or whole groups.
<p>The available groups are :
<p>
<XMP>
 BASIC = Move..., Copy..., Recycle... and Delete... functions plus constants
 _BASIC = FOF_... constants only
 HANDLES = DesktopHandle GetDesktopHandle WindowHandle GetWindowHandle
 INI = WriteToINI WriteToWININI ReadINI ReadWININI ReadINISectionKeys DeleteFromINI DeleteFromWININI
 DIALOGS = OpenDialog SaveAsDialog plus OFN_... constants
 _DIALOGS = only OFN_... constants
 RECENT = AddToRecentDocs, EmptyRecentDocs
 DIRECTORY = UpdateDir, FillInDir
 COMPRESS => Compress Uncompress Compressed SetCompression GetCompression
 MAP => Map Unmap Disconnect Mapped

</XMP>
<p>Examples:
<p>
<XMP>
 use Win32::FileOp qw(:BASIC GetDesktopHandle);
 use Win32::FileOp qw(:_BASIC MoveEx CopyEx);
 use Win32::FileOp qw(:INI :_DIALOGS SaveAsDialog);

</XMP>
<p>This module contains all methods from Win32::RecycleBin. The only change
you have to do is to use this module instead of the old Win32::RecycleBin.
Win32:RecycleBin is not supported anymore!
<p>
<H2> 
<A NAME="FileOp.pm_authors_0">
AUTHORS</A>
</H2>

<XMP>
 Module built by :
  Jan Krynicky <Jenda@Krynicky.cz>
  $Bill Luebkert <dbe@wgn.net>
  Mike Blazer <blazer@mail.nevalink.ru>
  Aldo Calpini <a.calpini@romagiubileo.it>
  Michael Yamada <myamada@gj.com>

</XMP>
<p>
</DL>

</BODY>
</HTML>
